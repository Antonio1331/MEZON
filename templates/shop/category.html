{% extends "base.html" %}
{% load i18n %}
{% block title %}
  {{ category.name }} — {% trans "категория" %} | {% trans "MEZON Market" %}
{% endblock %}

{% block meta_description %}
  {% trans "Купить в категории" %} «{{ category.name }}». {% trans "Выберите товары и оформите заказ онлайн — быстрая доставка." %}
{% endblock %}

{% block og_type %}website{% endblock %}


{% block hero %}
<div class="glass p-4 md:p-6">
  <div class="flex flex-col md:flex-row gap-3 items-start md:items-center justify-between">
    <div>
      <div class="text-2xl md:text-3xl font-extrabold leading-tight">{{ category.name }}</div>
      <div class="text-white/70 mt-1">{% trans "Выберите товары и добавляйте в корзину." %}</div>
    </div>

    <a href="{% url 'home' %}" class="badge-soft inline-flex items-center justify-center px-4 py-2 rounded-2xl">
      ← {% trans "На главную" %}
    </a>
  </div>
</div>
{% endblock %}

{% block content %}
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
  {% for product in products %}
    <div class="glass p-4 rounded-3xl">
      <a href="{% url 'product' product.id %}" class="block">
        {% if product.image %}
          <img src="{{ product.image.url }}" class="w-full h-44 object-cover rounded-2xl" alt="{{ product.name }}">
        {% else %}
          <div class="w-full h-44 rounded-2xl bg-white/5"></div>
        {% endif %}
        <div class="mt-3 font-bold text-lg">{{ product.name }}</div>
      </a>

      <div class="mt-1 text-white/70 text-sm line-clamp-2">{{ product.description }}</div>

      <div class="mt-3 flex items-center justify-between">
        <div class="text-xl font-extrabold">{{ product.price }}</div>
        {% if product.stock|default:0 > 0 %}
          <div class="text-xs text-white/60">{% trans "В наличии" %}: {{ product.stock }}</div>
        {% else %}
          <div class="text-xs text-white/60">{% trans "Нет в наличии" %}</div>
        {% endif %}
      </div>

      <div class="mt-4">
        {% if product.stock|default:0 > 0 %}
          <button
            type="button"
            class="btn-brand w-full text-center py-3 rounded-2xl text-base md:text-sm active:scale-[0.99] transition"
            data-add-to-cart
            data-url="{% url 'add_to_cart' product.id %}"
            data-name="{{ product.name|escapejs }}"
          >
            {% trans "В корзину" %}
          </button>
        {% else %}
          <button
            type="button"
            class="w-full text-center py-3 rounded-2xl text-base md:text-sm bg-white/10 text-white/50 cursor-not-allowed"
            disabled
          >
            {% trans "Нет в наличии" %}
          </button>
        {% endif %}
      </div>
    </div>
  {% empty %}
    <div class="glass p-6 rounded-3xl text-white/70">
      {% trans "В этой категории пока нет товаров." %}
    </div>
  {% endfor %}
</div>
{% endblock %}
